<div
  class="surface-card p-2 lg:p-5 shadow-2 border-round flex flex-column gap-2"
>
  <p-fileUpload
    mode="advanced"
    chooseLabel="Upload image"
    accept="image/*"
    [auto]="true"
    [customUpload]="true"
    (uploadHandler)="setImage($event.files[0])"
    (onClear)="removeImage()"
    (onRemove)="removeImage()"
  >
  </p-fileUpload>

  <div #canvas id="canvas" (resized)="onCanvasResized()"></div>

  <div class="flex flex-wrap align-items-center gap-2 sticky bottom-0">
    <ng-container *ngIf="imageObj">
      <p-button
        icon="pi pi-replay"
        (onClick)="setToDefault()"
        pTooltip="Set to default"
        tooltipPosition="top"
        [disabled]="!canModifyImage"
      ></p-button>

      <p-inputNumber
        [(ngModel)]="imageZoom"
        [showButtons]="true"
        buttonLayout="horizontal"
        inputId="horizontal"
        spinnerMode="horizontal"
        [step]="1"
        incrementButtonIcon="pi pi-plus"
        decrementButtonIcon="pi pi-minus"
        suffix="%"
        inputStyleClass="w-5rem"
        [disabled]="!canModifyImage"
      ></p-inputNumber>

      <p-dropdown
        [options]="selectionTools"
        [(ngModel)]="selectedSelectionTool"
        optionLabel="label"
        [showClear]="true"
        placeholder="Selection tool"
        (onChange)="onSelectionToolChanged()"
        appendTo="body"
      >
        <ng-template pTemplate="selectedItem">
          <div
            class="flex align-items-center gap-2"
            *ngIf="selectedSelectionTool"
          >
            <div class="flex gap-2 align-items-center">
              <i
                *ngIf="selectedSelectionTool.icon"
                [ngClass]="selectedSelectionTool.icon"
              ></i>
              <img
                *ngIf="selectedSelectionTool.svgPath"
                [src]="selectedSelectionTool.svgPath"
                alt="Free drawing icon"
                width="16"
                height="16"
              />
            </div>
          </div>
        </ng-template>
        <ng-template let-selectedSelectionTool pTemplate="item">
          <div class="flex align-items-center gap-2">
            <div class="flex gap-2 align-items-center">
              <i
                *ngIf="selectedSelectionTool.icon"
                [ngClass]="selectedSelectionTool.icon"
              ></i>
              <img
                *ngIf="selectedSelectionTool.svgPath"
                [src]="selectedSelectionTool.svgPath"
                alt="Free drawing icon"
                width="16"
                height="16"
              />
              <span>{{ selectedSelectionTool.label }}</span>
            </div>
          </div>
        </ng-template>
      </p-dropdown>

      <p-button
        *ngIf="selection"
        icon="pi pi-search"
        (onClick)="recognise()"
        pTooltip="Recognise color in selection"
        tooltipPosition="top"
        styleClass="p-button-success"
        [disabled]="recogniseButtonDisabled"
      ></p-button>
    </ng-container>
  </div>

  <div #matchColorTable>
    <p-table
      [hidden]="!matchColors.length"
      [value]="matchColors"
      [tableStyle]="{ 'min-width': '35rem' }"
      styleClass="p-datatable-sm p-datatable-striped"
    >
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="name">Color Name</th>
          <th>Code</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-color>
        <tr>
          <td>
            <span class="p-column-title">Name</span>
            <div class="flex justify-content-between align-items-center gap-2">
              <span>{{ color.name }}</span>
              <p-colorPicker
                [ngModel]="color.hexValue"
                [disabled]="true"
              ></p-colorPicker>
            </div>
          </td>
          <td>
            <span class="p-column-title"> Code </span> {{ color.hexValue }}
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
